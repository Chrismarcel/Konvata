<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
        crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Lato:100,300,400,500" rel="stylesheet">
    <link rel="stylesheet" href="./css/style.css">
    <title>Currency Converter</title>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-sm-offset-4 col-sm-4 main">
                <div class="converter">
                    <div class="converter-display">
                        <span class="converter-display__header text-center">
                            Currency Converter
                        </span>
                        <div class="converter__container">
                            <div class="col-xs-12 conversion">
                                <select name="currencies" class="form-control convert__currency-list" id="convert--to">
                                    <!-- <option value="NGN">NGN</option>
                                <option value="EUR">EUR</option>
                                <option value="USD">USD</option>
                                <option value="PHP">PHP</option> -->
                                </select>
                            </div>
                            <div class="col-xs-12 convert conversion__container--display">
                                <span class="converter__currency-display">0.00</span>
                            </div>
                        </div>
                    </div>
                    <div class="toggle-currency">
                        <button class="btn btn-primary toggle-currency__switch">
                            <span>&#11021;</span>
                        </button>
                    </div>
                    <div class="calculator__to-currency">
                        <div class="converter__container">
                            <div class="col-xs-12 conversion">
                                <select name="currencies" class="form-control convert__currency-list" id="convert--from">
                                    <!-- <option value="EUR">EUR</option>
                                <option value="NGN">NGN</option>
                                <option value="USD">USD</option>
                                <option value="PHP">PHP</option> -->
                                </select>
                            </div>
                            <div class="col-xs-12 convert conversion__container--convert">
                                <input type="text" class="form-control converter__currency-input" placeholder="0.00">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script src="./js/idb.js"></script>
<script src="./js/controller.js"></script>
<script src="./sw.js"></script>

<script>
    // Populate the select options via the listCurrencies static method
    const selectOptions = Array.from(document.querySelectorAll('.convert__currency-list'));
    CurrencyConverter.listCurrencies(selectOptions);

    const currencyLists = Array.from(document.querySelectorAll('.convert__currency-list'));
    currencyLists.map(currencyList => {
        currencyList.addEventListener('change', function () {
            convertCurrency();
        });
    });

    const inputBox = document.querySelector('.converter__currency-input');
    inputBox.addEventListener('keyup', () => {
        convertCurrency();
    });

    const toggleBtn = document.querySelector('.toggle-currency__switch');
    toggleBtn.addEventListener('click', function (event) {
        let currencyFrom = document.querySelector('#convert--from').value;
        let currencyTo = document.querySelector('#convert--to').value;
        let valueFrom = document.querySelector('.converter__currency-input').value;
        let valueFrom = document.querySelector('.converter__currency-display').textContent;

        // Use destructuring to swap values
        [currencyFrom, currencyTo] = [currencyTo, currencyFrom];

        document.querySelector('#convert--from').value = currencyFrom;
        document.querySelector('#convert--to').value = currencyTo;
        convertCurrency();
    });

    convertCurrency = () => {
        const currencyTo = document.querySelector('#convert--to').value;
        const currencyFrom = document.querySelector('#convert--from').value;
        const value = document.querySelector('.converter__currency-input').value;
        const currencies = `${currencyFrom}_${currencyTo}`;

        // Creates a new instance of CurrencyConverter
        const convertCurrency = new CurrencyConverter(currencies, value);
    }
</script>